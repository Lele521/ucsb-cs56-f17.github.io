---
num: "h09"
desc: "TBD"
ready: false
assigned: 2016-07-12 09:30:00.00-7:00
due: 2016-07-15 09:00:00.00-7:00
---

As preparation for your [lab06](/lab/lab06), please read both of the following. Note that links are available at 
the online version of this assignment, here: {{site.url}}{{page.url}}).

* [cs56-parsing-tutorial](https://github.com/UCSB-CS56-M16/cs56-parsing-tutorial).   
* Our tutorial on the [Visitor Design Pattern](https://github.com/UCSB-CS56-M16/visitor-pattern-tutorial)

<ol>

{% include hwk_li_name_10pts.html %}

<li markdown="1" style="margin-bottom:8em;">

(10 pts) In your own words, how does an AST capture the idea of operator precedence?

</li>

<li markdown="1" style="margin-bottom:8em;">

<div style="width: 30em; float:right; padding: 1em; margin:1em: border: 1px solid black;" markdown="1">
```java
public String speak(Animal animal) {
    if (animal instanceof Dog) {
      return "Bark!";
    } else if (animal instanceof Cat) {
      return "Meow";
    } else if (animal instanceof Fish) {
      return "Blub";
    } else {
      assert(false); // should not be possible
      return "IMPOSSIBLE";
    }
  }
```
</div>

(10 pts) The phrase *code smell* is used by some software developers to refer to things in "other people's code" that suggest that the code may have some problems, and needs to be refactored.

Long sequences of if/else statements that use `instanceof` are often considered to be a so-called *code smell*.   For example, the code in the box at right.

Please give at least two reasons that this style of code is not desirable, as compared to some of the available alternatives.



<div class="pagebreak"></div>

</li>


<li markdown="1" style="margin-bottom:9em;">

(10 pts) One of the main ideas in the [visitor pattern tutorial](https://github.com/UCSB-CS56-M16/visitor-pattern-tutorial) is the difference between single dispatch and double dispatch.  Suppose you were interviewing at some company (say, Amazon, Facebook, Google, Microsoft) and you got a head's up from an alum that "single vs. double dispatch" is one of the interview questions they ask to see if people "know their stuff".      What concise, but precise answer would you rehearse so that the interviewer would know you understand the difference?



</li>

<li markdown="1" style="margin-bottom:9em;">

<div style="width:50%; float:right; padding:0.5em; margin:0.5em; border: 1px solid black; line-height:2.0;" markdown="1">

```Java
 public String interactWith(Animal other) {
      return other.accept(new AnimalVisitor() {
        public String visitDog(Dog dog) {
            return "The cat runs away from the dog";
        }
        public String visitCat(Cat cat) {
            return "The cats stare at each other";
        }
        public String visitFish(Fish fish) {
            return "The cat jumps towards the fish's bowl.";
        }
      });
    }
```
</div>

The box at right shows the `interactWith` method of the `Dog` class implemented with the visitor pattern.   In this implementation, `AnimalVisitor` is defined with three methods, `visitDog`, `visitCat` and `visitFish`, each of which returns `String`.   Later in the tutorial, the author points out that we can parameterize/generalize the `AnimalVisitor` thus:

```java
public interface AnimalVisitor<A> {
  public A visitDog(Dog dog);
  public A visitCat(Cat cat);
  public A visitFish(Fish fish);
}
```

Two questions:

<ol>
  <li markdown="1" style="margin-below: 10em;"> 
     (10 pts) What is the motivation given for parameterizing the AnimalVisitor with `A`, the return type of the three visitors?
  </li>
  <li markdown="1" style="margin-below: 1em;"> What change(s) would you need to make to the code for `interactWith` if the `AnimalVisitor` interface were changed to this `AnimalVisitor<A>` interface?   Indicate the changes by crossing out code that would go away, and writing in code that would be added in its place.  You may use arrows to indicate where code will end up.

  </li>
  </ol>
</li>

<li markdown="1" style="margin-bottom:9em;">

(10 pts) TBD

</li>

</ol>

<div style="display:none">
http://UCSB-CS56-M16.github.io/hwk/h09
</div>
